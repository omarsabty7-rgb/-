-- // 1. تنظيف أي نسخة سابقة منعاً للتعليق //
local OldGui = game:GetService("CoreGui"):FindFirstChild("EliteHubSystem")
if OldGui then OldGui:Destroy() end

-- // 2. إعدادات المفتاح والروابط //
local CorrectKey = "ELITE-KEY-2026"
local DiscordLink = "https://discord.gg/yz5yADqe"

-- // 3. إنشاء واجهة نظام المفاتيح //
local KeySystemGui = Instance.new("ScreenGui")
KeySystemGui.Name = "EliteHubSystem"
KeySystemGui.Parent = game:GetService("CoreGui")

local KeyFrame = Instance.new("Frame", KeySystemGui)
KeyFrame.Size = UDim2.new(0, 280, 0, 160)
KeyFrame.Position = UDim2.new(0.5, -140, 0.5, -80)
KeyFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
KeyFrame.Active = true
KeyFrame.Draggable = true
Instance.new("UICorner", KeyFrame)

local KeyTitle = Instance.new("TextLabel", KeyFrame)
KeyTitle.Text = "ELITE HUB | KEY SYSTEM"
KeyTitle.Size = UDim2.new(1, 0, 0, 35)
KeyTitle.TextColor3 = Color3.new(1, 1, 1)
KeyTitle.BackgroundTransparency = 1
KeyTitle.Font = Enum.Font.GothamBold

local KeyInput = Instance.new("TextBox", KeyFrame)
KeyInput.PlaceholderText = "Enter Key Here..."
KeyInput.Size = UDim2.new(0.85, 0, 0, 35)
KeyInput.Position = UDim2.new(0.075, 0, 0.3, 0)
KeyInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
KeyInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", KeyInput)

local SubmitBtn = Instance.new("TextButton", KeyFrame)
SubmitBtn.Text = "SUBMIT"
SubmitBtn.Size = UDim2.new(0.4, 0, 0, 35)
SubmitBtn.Position = UDim2.new(0.075, 0, 0.65, 0)
SubmitBtn.BackgroundColor3 = Color3.fromRGB(220, 40, 40)
SubmitBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", SubmitBtn)

local GetKeyBtn = Instance.new("TextButton", KeyFrame)
GetKeyBtn.Text = "GET KEY"
GetKeyBtn.Size = UDim2.new(0.4, 0, 0, 35)
GetKeyBtn.Position = UDim2.new(0.525, 0, 0.65, 0)
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
GetKeyBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", GetKeyBtn)

-- // 4. السكريبت الأساسي الخاص بك (المدمج) //
local function loadMainHub()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "EliteMainHub"
    ScreenGui.Parent = game:GetService("CoreGui")

    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
    MainFrame.Size = UDim2.new(0, 280, 0, 560) -- حجم السكريبت الخاص بك
    MainFrame.Active = true
    MainFrame.Draggable = true
    Instance.new("UICorner", MainFrame)

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    Title.Text = "ELITE HUB V7 | BY GEMINI"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", Title)

    -- المتغيرات الأساسية
    local AimbotEnabled, Flying, SpeedEnabled, JumpEnabled, ESPEnabled, GodModeEnabled, NoRecoilEnabled = false, false, false, false, false, false, false
    local WalkSpeedValue, JumpPowerValue, FlySpeedValue, SmoothnessValue = 100, 150, 100, 0.1

    -- وظيفة إنشاء الأزرار (نفس تصميم سكريبتك)
    local function CreateToggleButton(name, pos, callback, isFullWidth)
        local active = false
        local btn = Instance.new("TextButton", MainFrame)
        btn.Text = name .. ": [OFF]"
        btn.Position = pos
        btn.Size = isFullWidth and UDim2.new(0.9, 0, 0, 35) or UDim2.new(0.6, 0, 0, 35)
        btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        btn.TextColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", btn)
        btn.MouseButton1Click:Connect(function()
            active = not active
            btn.Text = active and name .. ": [ON]" or name .. ": [OFF]"
            btn.BackgroundColor3 = active and Color3.fromRGB(220, 40, 40) or Color3.fromRGB(45, 45, 45)
            callback(active)
        end)
    end

    local function CreateValueInput(pos, defaultValue, callback)
        local input = Instance.new("TextBox", MainFrame)
        input.Text = tostring(defaultValue)
        input.Position = pos
        input.Size = UDim2.new(0.25, 0, 0, 35)
        input.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        input.TextColor3 = Color3.fromRGB(0, 255, 0)
        Instance.new("UICorner", input)
        input.FocusLost:Connect(function() callback(tonumber(input.Text) or defaultValue) end)
    end

    -- // الأزرار والوظائف //
    CreateToggleButton("SPEED", UDim2.new(0.05, 0, 0.1, 0), function(s) SpeedEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.1, 0), WalkSpeedValue, function(v) WalkSpeedValue = v end)

    CreateToggleButton("JUMP", UDim2.new(0.05, 0, 0.18, 0), function(s) JumpEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.18, 0), JumpPowerValue, function(v) JumpPowerValue = v end)

    CreateToggleButton("FLY (Space/Shift)", UDim2.new(0.05, 0, 0.26, 0), function(s)
        Flying = s
        local root = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if s and root then
            local bv = Instance.new("BodyVelocity", root)
            bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            task.spawn(function()
                while Flying do
                    local cam = workspace.CurrentCamera.CFrame
                    local move = Vector3.new(0, 0, 0)
                    local UIS = game:GetService("UserInputService")
                    if UIS:IsKeyDown("W") then move = move + cam.LookVector end
                    if UIS:IsKeyDown("S") then move = move - cam.LookVector end
                    if UIS:IsKeyDown("A") then move = move - cam.RightVector end
                    if UIS:IsKeyDown("D") then move = move + cam.RightVector end
                    if UIS:IsKeyDown("Space") then move = move + Vector3.new(0, 1, 0) end
                    if UIS:IsKeyDown("LeftShift") then move = move - Vector3.new(0, 1, 0) end
                    bv.Velocity = move * FlySpeedValue
                    task.wait()
                end
                bv:Destroy()
            end)
        end
    end)
    CreateValueInput(UDim2.new(0.7, 0, 0.26, 0), FlySpeedValue, function(v) FlySpeedValue = v end)

    CreateToggleButton("AIMBOT", UDim2.new(0.05, 0, 0.34, 0), function(s) AimbotEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.34, 0), SmoothnessValue, function(v) SmoothnessValue = v end)

    CreateToggleButton("GOD MODE", UDim2.new(0.05, 0, 0.42, 0), function(s)
        GodModeEnabled = s
        game.Players.LocalPlayer.Character.Humanoid:SetStateEnabled(Enum.HumanoidStateType.Dead, not s)
    end, true)

    CreateToggleButton("NO RECOIL", UDim2.new(0.05, 0, 0.50, 0), function(s)
        NoRecoilEnabled = s
        task.spawn(function()
            while NoRecoilEnabled do
                pcall(function()
                    for _, v in pairs(game:GetDescendants()) do
                        if v:IsA("ValueBase") and (v.Name:find("Recoil") or v.Name:find("Spread")) then v.Value = 0 end
                    end
                end)
                task.wait(2)
            end
        end)
    end, true)

    CreateToggleButton("SMART ESP", UDim2.new(0.05, 0, 0.58, 0), function(s)
        ESPEnabled = s
        if not s then
            for _, p in pairs(game.Players:GetPlayers()) do
                if p.Character and p.Character:FindFirstChild("EliteESP") then p.Character.EliteESP:Destroy() end
            end
        end
    end, true)

    -- الحلقات البرمجية (Loops)
    game:GetService("RunService").RenderStepped:Connect(function()
        if ESPEnabled then
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= game.Players.LocalPlayer and p.Character then
                    local h = p.Character:FindFirstChild("EliteESP") or Instance.new("Highlight", p.Character)
                    h.Name = "EliteESP"
                    h.FillColor = (p.Team == game.Players.LocalPlayer.Team) and Color3.new(0,0,1) or Color3.new(1,0,0)
                end
            end
        end
        if AimbotEnabled then
            local target, dist = nil, 1000
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= game.Players.LocalPlayer and p.Team ~= game.Players.LocalPlayer.Team and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local d = (p.Character.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                    if d < dist then target = p dist = d end
                end
            end
            if target then
                workspace.CurrentCamera.CFrame = workspace.CurrentCamera.CFrame:Lerp(CFrame.new(workspace.CurrentCamera.CFrame.Position, target.Character.HumanoidRootPart.Position), SmoothnessValue)
            end
        end
    end)

    game:GetService("RunService").Heartbeat:Connect(function()
        local char = game.Players.LocalPlayer.Character
        if char and char:FindFirstChild("Humanoid") then
            if SpeedEnabled then char.Humanoid.WalkSpeed = WalkSpeedValue end
            if JumpEnabled then char.Humanoid.JumpPower = JumpPowerValue char.Humanoid.UseJumpPower = true end
        end
    end)

    -- زر إغلاق الهب
    local CloseBtn = Instance.new("TextButton", MainFrame)
    CloseBtn.Text = "CLOSE HUB"
    CloseBtn.Size = UDim2.new(0.9, 0, 0, 35)
    CloseBtn.Position = UDim2.new(0.05, 0, 0.9, 0)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    CloseBtn.TextColor3 = Color3.new(1, 1, 1)
    CloseBtn.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
end

-- // 5. منطق نظام المفاتيح //
SubmitBtn.MouseButton1Click:Connect(function()
    if KeyInput.Text == CorrectKey then
        KeySystemGui:Destroy()
        loadMainHub()
    else
        SubmitBtn.Text = "INVALID!"
        task.wait(1)
        SubmitBtn.Text = "SUBMIT"
    end
end)

GetKeyBtn.MouseButton1Click:Connect(function()
    if setclipboard then setclipboard(DiscordLink) end
    GetKeyBtn.Text = "COPIED!"
    task.wait(1)
    GetKeyBtn.Text = "GET KEY"
end)
