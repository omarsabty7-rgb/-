-- // 1. إعدادات نظام المفاتيح //
local CorrectKey = "ELITE-KEY-2026" -- هذا هو المفتاح الذي يجب إدخاله
local DiscordLink = "https://discord.gg/yz5yADqe"

local KeyGui = Instance.new("ScreenGui")
local KeyFrame = Instance.new("Frame")
local KeyTitle = Instance.new("TextLabel")
local KeyInput = Instance.new("TextBox")
local SubmitBtn = Instance.new("TextButton")
local GetKeyBtn = Instance.new("TextButton")

-- إعداد واجهة المفتاح (Key UI)
KeyGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
KeyFrame.Name = "KeyFrame"
KeyFrame.Parent = KeyGui
KeyFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
KeyFrame.Position = UDim2.new(0.5, -135, 0.5, -90)
KeyFrame.Size = UDim2.new(0, 270, 0, 180)
KeyFrame.Active = true
KeyFrame.Draggable = true
Instance.new("UICorner", KeyFrame)

local Stroke = Instance.new("UIStroke", KeyFrame)
Stroke.Color = Color3.fromRGB(220, 40, 40)
Stroke.Thickness = 2

KeyTitle.Parent = KeyFrame
KeyTitle.Text = "ELITE HUB | KEY SYSTEM"
KeyTitle.Size = UDim2.new(1, 0, 0, 40)
KeyTitle.TextColor3 = Color3.new(1, 1, 1)
KeyTitle.Font = Enum.Font.SourceSansBold
KeyTitle.BackgroundTransparency = 1

KeyInput.Parent = KeyFrame
KeyInput.PlaceholderText = "Enter Key Here..."
KeyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
KeyInput.Size = UDim2.new(0.8, 0, 0, 35)
KeyInput.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
KeyInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", KeyInput)

SubmitBtn.Parent = KeyFrame
SubmitBtn.Text = "SUBMIT"
SubmitBtn.Position = UDim2.new(0.1, 0, 0.6, 0)
SubmitBtn.Size = UDim2.new(0.35, 0, 0, 35)
SubmitBtn.BackgroundColor3 = Color3.fromRGB(220, 40, 40)
SubmitBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", SubmitBtn)

GetKeyBtn.Parent = KeyFrame
GetKeyBtn.Text = "GET KEY"
GetKeyBtn.Position = UDim2.new(0.55, 0, 0.6, 0)
GetKeyBtn.Size = UDim2.new(0.35, 0, 0, 35)
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
GetKeyBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", GetKeyBtn)

-- // 2. وظيفة تحميل السكريبت الخاص بك (Main Script) //
local function loadMainHub()
    -- [ هنا تم دمج السكريبت الخاص بك بالكامل ]
    local ScreenGui = Instance.new("ScreenGui")
    local MainFrame = Instance.new("Frame")
    local UICorner = Instance.new("UICorner")
    local Title = Instance.new("TextLabel")
    local RunService = game:GetService("RunService")
    local UserInputService = game:GetService("UserInputService")

    local AimbotEnabled = false
    local Flying = false
    local SpeedEnabled = false
    local JumpEnabled = false
    local NoclipEnabled = false
    local ESPEnabled = false

    local WalkSpeedValue = 100
    local JumpPowerValue = 150
    local FlySpeedValue = 100
    local SmoothnessValue = 0.1 -- جعلناه أسرع قليلاً

    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    ScreenGui.ResetOnSpawn = false

    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
    MainFrame.Size = UDim2.new(0, 280, 0, 540) 
    MainFrame.Active = true
    MainFrame.Draggable = true
    Instance.new("UICorner", MainFrame)

    Title.Parent = MainFrame
    Title.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.Text = "ELITE HUB V7 | ACCESS GRANTED"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.TextSize = 16
    Instance.new("UICorner", Title)

    local function CreateToggleButton(name, pos, callback, isFullWidth)
        local active = false
        local btn = Instance.new("TextButton", MainFrame)
        btn.Text = name .. ": [OFF]"
        btn.Position = pos
        btn.Size = isFullWidth and UDim2.new(0.9, 0, 0, 35) or UDim2.new(0.6, 0, 0, 35)
        btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        btn.TextColor3 = Color3.new(1,1,1)
        btn.Font = Enum.Font.SourceSansBold
        Instance.new("UICorner", btn)

        btn.MouseButton1Click:Connect(function()
            active = not active
            btn.Text = active and name .. ": [ON]" or name .. ": [OFF]"
            btn.BackgroundColor3 = active and Color3.fromRGB(220, 40, 40) or Color3.fromRGB(45, 45, 45)
            callback(active)
        end)
    end

    local function CreateValueInput(pos, defaultValue, callback)
        local input = Instance.new("TextBox", MainFrame)
        input.Text = tostring(defaultValue)
        input.Position = pos
        input.Size = UDim2.new(0.2, 0, 0, 35)
        input.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        input.TextColor3 = Color3.fromRGB(0, 255, 0)
        Instance.new("UICorner", input)
        input.FocusLost:Connect(function() callback(tonumber(input.Text) or defaultValue) end)
    end

    -- Controls
    CreateToggleButton("SPEED", UDim2.new(0.05, 0, 0.12, 0), function(s) SpeedEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.12, 0), WalkSpeedValue, function(v) WalkSpeedValue = v end)

    CreateToggleButton("JUMP", UDim2.new(0.05, 0, 0.22, 0), function(s) JumpEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.22, 0), JumpPowerValue, function(v) JumpPowerValue = v end)

    CreateToggleButton("FLY (Space/Shift)", UDim2.new(0.05, 0, 0.32, 0), function(s)
        Flying = s
        NoclipEnabled = s
        local root = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if Flying and root then
            local bv = Instance.new("BodyVelocity", root)
            bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            task.spawn(function()
                while Flying do
                    local cam = workspace.CurrentCamera.CFrame
                    local newVel = Vector3.new(0,0,0)
                    if UserInputService:IsKeyDown(Enum.KeyCode.W) then newVel = newVel + cam.LookVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.S) then newVel = newVel - cam.LookVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.D) then newVel = newVel + cam.RightVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.A) then newVel = newVel - cam.RightVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.Space) then newVel = newVel + Vector3.new(0,1,0) end
                    if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then newVel = newVel - Vector3.new(0,1,0) end
                    bv.Velocity = newVel * FlySpeedValue
                    task.wait()
                end
                bv:Destroy()
            end)
        end
    end)
    CreateValueInput(UDim2.new(0.7, 0, 0.32, 0), FlySpeedValue, function(v) FlySpeedValue = v end)

    CreateToggleButton("AIMBOT (ENEMIES)", UDim2.new(0.05, 0, 0.42, 0), function(s) AimbotEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.42, 0), SmoothnessValue, function(v) SmoothnessValue = v end)

    CreateToggleButton("SMART ESP", UDim2.new(0.05, 0, 0.52, 0), function(s) ESPEnabled = s end, true)

    -- Loops (ESP & Physics)
    RunService.Stepped:Connect(function()
        for _, p in pairs(game.Players:GetPlayers()) do
            if p ~= game.Players.LocalPlayer and p.Character then
                local h = p.Character:FindFirstChild("ESPHighlight")
                if ESPEnabled then
                    if not h then h = Instance.new("Highlight", p.Character); h.Name = "ESPHighlight" end
                    h.FillColor = (p.Team == game.Players.LocalPlayer.Team) and Color3.new(0,0,1) or Color3.new(1,0,0)
                elseif h then h:Destroy() end
            end
        end
    end)

    RunService.Heartbeat:Connect(function()
        local char = game.Players.LocalPlayer.Character
        if char and char:FindFirstChild("Humanoid") then
            if SpeedEnabled then char.Humanoid.WalkSpeed = WalkSpeedValue end
            if JumpEnabled then char.Humanoid.JumpPower = JumpPowerValue char.Humanoid.UseJumpPower = true end
            if NoclipEnabled then
                for _, part in pairs(char:GetDescendants()) do if part:IsA("BasePart") then part.CanCollide = false end end
            end
        end
    end)

    RunService.RenderStepped:Connect(function()
        if AimbotEnabled then
            local target, dist = nil, 1000
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= game.Players.LocalPlayer and p.Team ~= game.Players.LocalPlayer.Team and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local d = (p.Character.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                    if d < dist then target = p dist = d end
                end
            end
            if target then
                workspace.CurrentCamera.CFrame = workspace.CurrentCamera.CFrame:Lerp(CFrame.new(workspace.CurrentCamera.CFrame.Position, target.Character.HumanoidRootPart.Position), SmoothnessValue)
            end
        end
    end)

    local close = Instance.new("TextButton", MainFrame)
    close.Text = "CLOSE HUB"
    close.Size = UDim2.new(0.9, 0, 0, 40)
    close.Position = UDim2.new(0.05, 0, 0.88, 0)
    close.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    close.TextColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", close)
    close.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
end

-- // 3. برمجة أزرار التحقق //
GetKeyBtn.MouseButton1Click:Connect(function()
    setclipboard(DiscordLink)
    GetKeyBtn.Text = "LINK COPIED!"
    task.wait(2)
    GetKeyBtn.Text = "GET KEY"
end)

SubmitBtn.MouseButton1Click:Connect(function()
    if KeyInput.Text == CorrectKey then
        SubmitBtn.Text = "SUCCESS!"
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        task.wait(1)
        KeyGui:Destroy()
        loadMainHub() -- تشغيل السكريبت الخاص بك
    else
        SubmitBtn.Text = "INVALID KEY!"
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        task.wait(2)
        SubmitBtn.Text = "SUBMIT"
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(220, 40, 40)
    end
end)
