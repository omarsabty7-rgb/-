-- // 1. إعدادات نظام المفاتيح //
local CorrectKey = "ELITE-KEY-2026" 
local DiscordLink = "https://discord.gg/yz5yADqe"

local KeyGui = Instance.new("ScreenGui")
local KeyFrame = Instance.new("Frame")
local KeyTitle = Instance.new("TextLabel")
local KeyInput = Instance.new("TextBox")
local SubmitBtn = Instance.new("TextButton")
local GetKeyBtn = Instance.new("TextButton")

KeyGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
KeyFrame.Name = "KeyFrame"
KeyFrame.Parent = KeyGui
KeyFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
KeyFrame.Position = UDim2.new(0.5, -135, 0.5, -90)
KeyFrame.Size = UDim2.new(0, 270, 0, 180)
KeyFrame.Active = true
KeyFrame.Draggable = true
Instance.new("UICorner", KeyFrame)

local Stroke = Instance.new("UIStroke", KeyFrame)
Stroke.Color = Color3.fromRGB(220, 40, 40)
Stroke.Thickness = 2

KeyTitle.Parent = KeyFrame
KeyTitle.Text = "ELITE HUB | KEY SYSTEM"
KeyTitle.Size = UDim2.new(1, 0, 0, 40)
KeyTitle.TextColor3 = Color3.new(1, 1, 1)
KeyTitle.Font = Enum.Font.SourceSansBold
KeyTitle.BackgroundTransparency = 1

KeyInput.Parent = KeyFrame
KeyInput.PlaceholderText = "Enter Key Here..."
KeyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
KeyInput.Size = UDim2.new(0.8, 0, 0, 35)
KeyInput.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
KeyInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", KeyInput)

SubmitBtn.Parent = KeyFrame
SubmitBtn.Text = "SUBMIT"
SubmitBtn.Position = UDim2.new(0.1, 0, 0.6, 0)
SubmitBtn.Size = UDim2.new(0.35, 0, 0, 35)
SubmitBtn.BackgroundColor3 = Color3.fromRGB(220, 40, 40)
SubmitBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", SubmitBtn)

GetKeyBtn.Parent = KeyFrame
GetKeyBtn.Text = "GET KEY"
GetKeyBtn.Position = UDim2.new(0.55, 0, 0.6, 0)
GetKeyBtn.Size = UDim2.new(0.35, 0, 0, 35)
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
GetKeyBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", GetKeyBtn)

-- // 2. وظيفة تحميل السكريبت الأساسي //
local function loadMainHub()
    local ScreenGui = Instance.new("ScreenGui")
    local MainFrame = Instance.new("Frame")
    local RunService = game:GetService("RunService")
    local UserInputService = game:GetService("UserInputService")
    local LocalPlayer = game.Players.LocalPlayer

    -- القيم الافتراضية
    local AimbotEnabled, Flying, SpeedEnabled, JumpEnabled = false, false, false, false
    local ESPEnabled, GodModeEnabled, NoRecoilEnabled = false, false, false
    local WalkSpeedValue, JumpPowerValue, FlySpeedValue, SmoothnessValue = 100, 150, 100, 0.1

    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
    MainFrame.Size = UDim2.new(0, 280, 0, 620) -- تم زيادة الحجم للإضافات الجديدة
    MainFrame.Active, MainFrame.Draggable = true, true
    Instance.new("UICorner", MainFrame)

    local Title = Instance.new("TextLabel", MainFrame)
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    Title.Text = "ELITE HUB V7 | GOD MODE + RECOIL"
    Title.TextColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", Title)

    local function CreateToggleButton(name, pos, callback, isFullWidth)
        local active = false
        local btn = Instance.new("TextButton", MainFrame)
        btn.Text = name .. ": [OFF]"
        btn.Position = pos
        btn.Size = isFullWidth and UDim2.new(0.9, 0, 0, 32) or UDim2.new(0.6, 0, 0, 32)
        btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        btn.TextColor3 = Color3.new(1,1,1)
        Instance.new("UICorner", btn)
        btn.MouseButton1Click:Connect(function()
            active = not active
            btn.Text = active and name .. ": [ON]" or name .. ": [OFF]"
            btn.BackgroundColor3 = active and Color3.fromRGB(220, 40, 40) or Color3.fromRGB(45, 45, 45)
            callback(active)
        end)
    end

    local function CreateValueInput(pos, defaultValue, callback)
        local input = Instance.new("TextBox", MainFrame)
        input.Text = tostring(defaultValue)
        input.Position = pos
        input.Size = UDim2.new(0.2, 0, 0, 32)
        input.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        input.TextColor3 = Color3.fromRGB(0, 255, 0)
        Instance.new("UICorner", input)
        input.FocusLost:Connect(function() callback(tonumber(input.Text) or defaultValue) end)
    end

    -- الأزرار
    CreateToggleButton("SPEED", UDim2.new(0.05, 0, 0.08, 0), function(s) SpeedEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.08, 0), WalkSpeedValue, function(v) WalkSpeedValue = v end)

    CreateToggleButton("JUMP", UDim2.new(0.05, 0, 0.15, 0), function(s) JumpEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.15, 0), JumpPowerValue, function(v) JumpPowerValue = v end)

    CreateToggleButton("FLY (Space/Shift)", UDim2.new(0.05, 0, 0.22, 0), function(s)
        Flying = s
        local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if Flying and root then
            local bv = Instance.new("BodyVelocity", root)
            bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            task.spawn(function()
                while Flying do
                    local cam = workspace.CurrentCamera.CFrame
                    local newVel = Vector3.new(0,0,0)
                    if UserInputService:IsKeyDown(Enum.KeyCode.W) then newVel = newVel + cam.LookVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.S) then newVel = newVel - cam.LookVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.D) then newVel = newVel + cam.RightVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.A) then newVel = newVel - cam.RightVector end
                    if UserInputService:IsKeyDown(Enum.KeyCode.Space) then newVel = newVel + Vector3.new(0,1,0) end
                    if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then newVel = newVel - Vector3.new(0,1,0) end
                    bv.Velocity = newVel * FlySpeedValue
                    task.wait()
                end
                bv:Destroy()
            end)
        end
    end)
    CreateValueInput(UDim2.new(0.7, 0, 0.22, 0), FlySpeedValue, function(v) FlySpeedValue = v end)

    CreateToggleButton("AIMBOT (ENEMIES)", UDim2.new(0.05, 0, 0.29, 0), function(s) AimbotEnabled = s end)
    CreateValueInput(UDim2.new(0.7, 0, 0.29, 0), SmoothnessValue, function(v) SmoothnessValue = v end)

    CreateToggleButton("GOD MODE", UDim2.new(0.05, 0, 0.36, 0), function(s) 
        GodModeEnabled = s 
        if s then
            -- ميزة الـ God Mode البسيطة (إلغاء تدمير الشخصية عند الموت)
            LocalPlayer.Character.Humanoid.Name = "EliteHumanoid" -- بعض الألعاب لا تتعرف على الاسم المختلف فلا تقتل اللاعب
        else
            LocalPlayer.Character.Humanoid.Name = "Humanoid"
        end
    end, true)

    CreateToggleButton("NO RECOIL", UDim2.new(0.05, 0, 0.43, 0), function(s) NoRecoilEnabled = s end, true)
    CreateToggleButton("SMART ESP", UDim2.new(0.05, 0, 0.50, 0), function(s) ESPEnabled = s end, true)

    -- // وظيفة No Recoil //
    task.spawn(function()
        while task.wait(0.5) do
            if NoRecoilEnabled then
                pcall(function()
                    for _, v in pairs(LocalPlayer.Backpack:GetChildren()) do
                        if v:IsA("Tool") and v:FindFirstChild("Stats") then -- تعديل القيم إذا كانت موجودة
                            for _, stat in pairs(v.Stats:GetChildren()) do
                                if stat.Name:find("Recoil") or stat.Name:find("Spread") then stat.Value = 0 end
                            end
                        end
                    end
                end)
            end
        end
    end)

    -- // الحلقات البرمجية //
    RunService.Heartbeat:Connect(function()
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("Humanoid") then
            if SpeedEnabled then char.Humanoid.WalkSpeed = WalkSpeedValue end
            if JumpEnabled then char.Humanoid.JumpPower = JumpPowerValue char.Humanoid.UseJumpPower = true end
            if GodModeEnabled and char.Humanoid.Health > 0 and char.Humanoid.Health < 20 then
                char.Humanoid.Health = 100 -- محاولة استرجاع الصحة تلقائياً
            end
        end
    end)

    RunService.RenderStepped:Connect(function()
        if AimbotEnabled then
            local target, dist = nil, 1000
            for _, p in pairs(game.Players:GetPlayers()) do
                if p ~= LocalPlayer and p.Team ~= LocalPlayer.Team and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local d = (p.Character.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                    if d < dist then target = p dist = d end
                end
            end
            if target then
                workspace.CurrentCamera.CFrame = workspace.CurrentCamera.CFrame:Lerp(CFrame.new(workspace.CurrentCamera.CFrame.Position, target.Character.HumanoidRootPart.Position), SmoothnessValue)
            end
        end
    end)

    -- زر الديسكورد المدمج في الهب
    local dsc = Instance.new("TextButton", MainFrame)
    dsc.Text = "COPY DISCORD"
    dsc.Position = UDim2.new(0.05, 0, 0.75, 0)
    dsc.Size = UDim2.new(0.9, 0, 0, 35)
    dsc.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    dsc.TextColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", dsc)
    dsc.MouseButton1Click:Connect(function() setclipboard(DiscordLink) end)

    local close = Instance.new("TextButton", MainFrame)
    close.Text = "CLOSE HUB"
    close.Position = UDim2.new(0.05, 0, 0.88, 0)
    close.Size = UDim2.new(0.9, 0, 0, 35)
    close.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
    close.TextColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", close)
    close.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
end

-- // 3. برمجة نظام المفاتيح //
GetKeyBtn.MouseButton1Click:Connect(function()
    setclipboard(DiscordLink)
    GetKeyBtn.Text = "LINK COPIED!"
    task.wait(2)
    GetKeyBtn.Text = "GET KEY"
end)

SubmitBtn.MouseButton1Click:Connect(function()
    if KeyInput.Text == CorrectKey then
        SubmitBtn.Text = "SUCCESS!"
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        task.wait(1)
        KeyGui:Destroy()
        loadMainHub()
    else
        SubmitBtn.Text = "WRONG KEY!"
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        task.wait(2)
        SubmitBtn.Text = "SUBMIT"
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(220, 40, 40)
    end
end)
