local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local Title = Instance.new("TextLabel")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- // إعدادات القيم الافتراضية
local AimbotEnabled = false
local Flying = false
local SpeedEnabled = false
local JumpEnabled = false
local NoclipEnabled = false
local ESPEnabled = false

local WalkSpeedValue = 100
local JumpPowerValue = 150
local FlySpeedValue = 100
local SmoothnessValue = 0.1

-- // إعداد الواجهة (UI Setup)
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
MainFrame.Position = UDim2.new(0.5, -140, 0.5, -270)
MainFrame.Size = UDim2.new(0, 280, 0, 540) 
MainFrame.Active = true
MainFrame.Draggable = true

Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 10)
local UIStroke = Instance.new("UIStroke", MainFrame)
UIStroke.Color = Color3.fromRGB(220, 40, 40)
UIStroke.Thickness = 1.5

Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Title.Size = UDim2.new(1, 0, 0, 45)
Title.Text = "  ELITE HUB V7 | TEAM CHECK"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14
Title.TextXAlignment = Enum.TextXAlignment.Left
Instance.new("UICorner", Title)

-- // وظائف الإنشاء (Toggle & Input)
local function CreateToggleButton(name, pos, callback, isFullWidth)
    local active = false
    local btn = Instance.new("TextButton", MainFrame)
    btn.Text = name .. ": [OFF]"
    btn.Position = pos
    btn.Size = isFullWidth and UDim2.new(0.9, 0, 0, 38) or UDim2.new(0.63, 0, 0, 38)
    btn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    btn.TextColor3 = Color3.fromRGB(200, 200, 200)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 10
    Instance.new("UICorner", btn)
    btn.MouseButton1Click:Connect(function()
        active = not active
        btn.Text = active and name .. ": [ON]" or name .. ": [OFF]"
        btn.BackgroundColor3 = active and Color3.fromRGB(220, 40, 40) or Color3.fromRGB(35, 35, 35)
        callback(active)
    end)
end

local function CreateValueInput(pos, defaultValue, callback)
    local input = Instance.new("TextBox", MainFrame)
    input.Text = tostring(defaultValue)
    input.Position = pos
    input.Size = UDim2.new(0, 65, 0, 38)
    input.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    input.TextColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", input)
    input.FocusLost:Connect(function() callback(tonumber(input.Text) or 0) end)
end

-- // أزرار التحكم
CreateToggleButton("WALK SPEED", UDim2.new(0.05, 0, 0.12, 0), function(s) SpeedEnabled = s end)
CreateValueInput(UDim2.new(0.71, 0, 0.12, 0), WalkSpeedValue, function(v) WalkSpeedValue = v end)

CreateToggleButton("JUMP POWER", UDim2.new(0.05, 0, 0.20, 0), function(s) JumpEnabled = s end)
CreateValueInput(UDim2.new(0.71, 0, 0.20, 0), JumpPowerValue, function(v) JumpPowerValue = v end)

CreateToggleButton("FLY HACK", UDim2.new(0.05, 0, 0.28, 0), function(s) 
    Flying = s 
    NoclipEnabled = s 
    local root = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if s and root then
        local bv = Instance.new("BodyVelocity", root)
        bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        task.spawn(function()
            while Flying do
                local cam = workspace.CurrentCamera.CFrame
                local move = Vector3.new()
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then move = move + cam.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then move = move - cam.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then move = move + cam.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then move = move - cam.RightVector end
                bv.Velocity = move * FlySpeedValue
                task.wait()
            end
            bv:Destroy()
        end)
    end
end)
CreateValueInput(UDim2.new(0.71, 0, 0.28, 0), FlySpeedValue, function(v) FlySpeedValue = v end)

CreateToggleButton("AIMBOT (ENEMIES)", UDim2.new(0.05, 0, 0.36, 0), function(s) AimbotEnabled = s end)
CreateValueInput(UDim2.new(0.71, 0, 0.36, 0), SmoothnessValue, function(v) SmoothnessValue = v end)

CreateToggleButton("SMART ESP", UDim2.new(0.05, 0, 0.44, 0), function(s) ESPEnabled = s end, true)

-- // Aimbot Logic (With Team Check)
RunService.RenderStepped:Connect(function()
    if AimbotEnabled then
        local target, closest = nil, 1000
        for _, p in pairs(Players:GetPlayers()) do
            -- فحص: ليس أنا + لديه شخصية + ليس في فريقي (الأعداء فقط)
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                if p.Team ~= LocalPlayer.Team then 
                    local pos, vis = workspace.CurrentCamera:WorldToViewportPoint(p.Character.HumanoidRootPart.Position)
                    if vis then
                        local mag = (Vector2.new(pos.X, pos.Y) - UserInputService:GetMouseLocation()).Magnitude
                        if mag < closest then target = p; closest = mag end
                    end
                end
            end
        end
        if target then
            workspace.CurrentCamera.CFrame = workspace.CurrentCamera.CFrame:Lerp(CFrame.new(workspace.CurrentCamera.CFrame.Position, target.Character.HumanoidRootPart.Position), SmoothnessValue)
        end
    end
end)

-- // ESP & Physics Loops
RunService.Stepped:Connect(function()
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer and p.Character then
            local h = p.Character:FindFirstChild("ESPHighlight")
            if ESPEnabled then
                if not h then h = Instance.new("Highlight", p.Character); h.Name = "ESPHighlight" end
                h.FillColor = (p.Team == LocalPlayer.Team) and Color3.new(0,0,1) or Color3.new(1,0,0)
            elseif h then h:Destroy() end
        end
    end
end)

RunService.Heartbeat:Connect(function()
    local Hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
    if Hum then
        if SpeedEnabled then Hum.WalkSpeed = WalkSpeedValue end
        if JumpEnabled then Hum.JumpPower = JumpPowerValue; Hum.UseJumpPower = true end
    end
end)

-- // Discord Button
local disc = Instance.new("TextButton", MainFrame)
disc.Text = "JOIN DISCORD"
disc.Size = UDim2.new(0.9, 0, 0, 40)
disc.Position = UDim2.new(0.05, 0, 0.54, 0)
disc.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
disc.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", disc)
disc.MouseButton1Click:Connect(function() setclipboard("https://discord.gg/yz5yADqe") end)

-- // Close Button
local close = Instance.new("TextButton", MainFrame)
close.Text = "CLOSE HUB"
close.Size = UDim2.new(0.9, 0, 0, 40)
close.Position = UDim2.new(0.05, 0, 0.88, 0)
close.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
close.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", close)
close.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
